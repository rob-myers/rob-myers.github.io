"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7642],{87642:function(e,t,r){r.r(t),r.d(t,{default:function(){return A}});var n,o=r(52209),c=r(92809),i=r(88269),a=r(24790),u=r(84175),f=r(91441),s=r(49345),l=r(35650),p=r(95814),d=r(35490),h=r(83159),g=r(59748),y=r(94184),v=r.n(y),b=r(8311);function O(e){var t=e.json,r=(0,l.Z)((function(){return{api:{evt:new a.x},open:{},onClick:function(t){var n=t.target,o=Number(n.getAttribute("data-index")),c=n.classList.toggle("open");r.open[o]=c,e.wire.next({key:c?"opened-door":"closed-door",index:o})}}}));return(0,b.tZ)("g",{className:w,onPointerUp:r.onClick,children:t.doors.map((function(e,t){var n=e.rect,o=e.angle;return(0,b.tZ)("rect",{"data-index":t,className:v()("door",{open:r.open[t]}),x:n.x,y:n.y,width:n.width,height:n.height,style:{transform:"rotate(".concat(o,"rad)"),transformOrigin:"".concat(n.x,"px ").concat(n.y,"px")}},t)}))})}var w=(0,i.iv)(n||(n=(0,o.Z)(["\n  rect.door {\n    cursor: pointer;\n    fill: #000;\n    opacity: 1;\n    transition: opacity 100ms linear;\n    &.open {\n      opacity: 0;\n    }\n  }\n"]))),m=r(79056),j=r(48103),P=r(68451),k=r(27375);function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e){var t=(0,k.Z)(),r=(0,l.Z)((function(){return{key:"Lights_".concat(e.json.id),lights:[],doors:{},computeLights:function(e){var t=e.json,n=e.defs,o=j.LA.from(t.hull.poly[0]).removeHoles(),c=t.walls.concat(t.doors.filter((function(e,t){return"open"!==r.doors[t]})).map((function(e){return e.poly}))).map((function(e){return j.LA.from(e)})).flatMap((function(e){return P.J.triangulationToPolys(e.fastTriangulate())})),i=n.filter((function(e){var t=(0,m.Z)(e.def,1)[0];return o.contains(t)}));r.lights=i.map((function(e,t){var r=(0,m.Z)(e.def,4),n=r[0],o=r[1],i=r[2],a=r[3],u=P.J.lightPolygon(n,o,c),f=u.rect,s=new j.dl((n.x-f.x)/f.width,(n.y-f.y)/f.height),l=f.width>=f.height?new j.dl(1,f.width/f.height):new j.dl(f.height/f.width,1);return{key:"light",index:t,maskId:a,intensity:i,position:n,poly:u,ratio:s,r:o/(Math.max(f.width,f.height)/2)*.5,scale:l}}))}}}));return g.default.useEffect((function(){r.computeLights(e);var n=e.wire.subscribe((function(n){switch(n.key){case"opened-door":r.doors[n.index]="open",r.computeLights(e),t();break;case"closed-door":r.doors[n.index]="closed",r.computeLights(e),t()}}));return function(){return n.unsubscribe()}}),[e.defs]),(0,b.BX)(b.HY,{children:[(0,b.BX)("defs",{children:[r.lights.map((function(e,t){var n=e.ratio,o=e.scale,c=e.r,i=e.intensity;return(0,b.BX)("radialGradient",{id:"radial-".concat(r.key,"-").concat(t),cx:n.x,cy:n.y,r:c,gradientTransform:"translate(".concat(n.x,", ").concat(n.y,") scale(").concat(o.x,", ").concat(o.y,") translate(").concat(-n.x,", ").concat(-n.y,")"),children:[(0,b.tZ)("stop",{offset:"0%","stop-color":"rgb(".concat(255*i>>0,", ").concat(255*i>>0,", ").concat(255*i>>0,")")}),(0,b.tZ)("stop",{offset:"90%","stop-color":"#000"}),(0,b.tZ)("stop",{offset:"100%","stop-color":"#000"})]})})),[0,1].map((function(e){return(0,b.tZ)("mask",{id:"mask-".concat(r.key,"-").concat(e),children:r.lights.filter((function(t){return t.maskId===e})).map((function(e){var t=e.poly,n=e.index;return(0,b.tZ)("path",{d:t.svgPath,fill:"url(#radial-".concat(r.key,"-").concat(n,")")})}))})}))]}),[0,1].map((function(t){return(0,b.tZ)("image",x(x({},e.json.pngRect),{},{className:"geomorph-light",href:(0,f.qX)(e.json.key),mask:"url(#mask-".concat(r.key,"-").concat(t,")")}))})),r.lights.map((function(e){var t=e.position;return(0,b.tZ)(b.HY,{children:(0,b.tZ)("image",{href:"/icon/Simple_Icon_Eye.svg",width:"20",height:"20",x:t.x-10,y:t.y-10})})}))]})}var E,S=r(30266),_=r(809),I=r.n(_),L=r(88767);function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=(0,L.useQuery)("Image:".concat(e.href,"(").concat(e.darken||0,")"),(0,S.Z)(I().mark((function t(){var r,n,o,c;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new Image,n=document.createElement("canvas"),t.next=4,new Promise((function(t,n){r.src=e.href,r.onload=function(){return t(r)},r.onerror=function(){return n(new Error("failed to load image: ".concat(e.href)))}}));case 4:return o=[r.width,r.height],n.width=o[0],n.height=o[1],(c=(0,u.Cq)(n.getContext("2d"))).drawImage(r,0,0),c.fillStyle="rgba(0, 0, 0, ".concat(e.darken,")"),c.fillRect(0,0,n.width,n.height),t.abrupt("return",n.toDataURL());case 12:case"end":return t.stop()}}),t)})))).data;return(0,b.tZ)("image",q(q({},e),{},{href:t}))}function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){(0,c.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e){var t=(0,p.Z)(H).data,r=(0,l.Z)((function(){return{lightDefs:[{key:"light-def",def:[new s.d(205,385),170,1,0]},{key:"light-def",def:[new s.d(620,430),250,.8,0]},{key:"light-def",def:[new s.d(420,400),250,.4,1]},{key:"light-def",def:[new s.d(620,315),250,1,1]}],wire:new a.x}}),{lightDefs:function(e,t){return(0,u.fS)(e,t)}});return(0,b.tZ)(h.Z,{dark:!0,gridBounds:d.l,initViewBox:d.r,maxZoom:6,className:F,children:t&&(0,b.BX)(b.HY,{children:[(0,b.tZ)(C,B(B({},t.pngRect),{},{className:"geomorph",href:(0,f.qX)(H),darken:.95})),(0,b.tZ)(D,{json:t,defs:r.lightDefs,wire:r.wire}),(0,b.tZ)(O,{json:t,wire:r.wire})]})})}var H="g-301--bridge",F=(0,i.iv)(E||(E=(0,o.Z)(["\n  path.shadow {\n    fill: #00000066;\n    pointer-events: none;\n  }\n"])))},95814:function(e,t,r){r.d(t,{Z:function(){return d}});var n=r(92809),o=r(79056),c=r(30266),i=r(809),a=r.n(i),u=r(88767),f=r(18264),s=r(91441);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e){return(0,u.useQuery)((0,s.tU)(e),(0,c.Z)(a().mark((function t(){var r,n,c,i,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([fetch((0,s.tU)(e)).then((function(e){return e.json()})),new Promise((function(t,r){var n=new Image;n.onload=function(){return t(n)},n.onerror=r,n.src=(0,s.qX)(e)}))]);case 2:return r=t.sent,n=(0,o.Z)(r,2),c=n[0],i=n[1],u=p(p({},c),{},{image:i,d:{navPoly:c.navPoly.map(f.L.from),hullOutine:f.L.from(c.hull.poly[0]).removeHoles()}}),t.abrupt("return",u);case 8:case"end":return t.stop()}}),t)}))),{keepPreviousData:!0,cacheTime:1/0})}},35650:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(79056),o=r(59748);function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.default.useState(e),c=(0,n.Z)(r,1),i=c[0];return o.default.useEffect((function(){var r=e.toString()!==i._prevFn;if(i._prevFn){if(r){for(var o=e(),c=0,a=Object.entries(o);c<a.length;c++){var u,f=(0,n.Z)(a[c],2),s=f[0],l=f[1];"function"===typeof l?i[s]=l:s in i?i._prevInit&&!1===(null===(u=t[s])||void 0===u?void 0:u.call(t,i._prevInit[s],o[s]))&&(i[s]=o[s]):i[s]=l}for(var p=0,d=Object.entries(i);p<d.length;p++){var h=(0,n.Z)(d[p],2),g=h[0];h[1];g in o||delete i[g]}i._prevFn=e.toString(),i._prevInit=o}}else i._prevFn=e.toString(),i._prevInit=e()}),[]),i}},84175:function(e,t,r){function n(e,t){if(void 0===e)throw new Error("Encountered unexpected undefined value".concat(t?" for '".concat(t,"'"):""));return e}function o(e,t){if(null==e)throw new Error("Encountered unexpected null or undefined value".concat(t?" for '".concat(t,"'"):""));return e}function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r>10)throw Error("equals: recursive depth exceeded 10");return(void 0===e||void 0!==t)&&("function"===typeof(null===e||void 0===e?void 0:e.equals)?!0===e.equals(t):Array.isArray(e)?e.every((function(e,r){return c(e,t[r])}),r+1)&&e.length===t.length:i(e)?Object.keys(e).every((function(r){return c(e[r],t[r])}),r+1)&&Object.keys(e).length===Object.keys(t).length:e===t)}function i(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}r.d(t,{Nh:function(){return n},Cq:function(){return o},fS:function(){return c}})}}]);