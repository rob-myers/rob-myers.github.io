"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3481],{73481:function(e,n,t){t.r(n),t.d(n,{default:function(){return m}});var o,r=t(52209),i=t(59748),a=t(88269),s=t(95090),l=t(36694),c=t(48103),d=t(91441),u=t(2074),p=t(35650),g=t(27375),h=t(87079),f=t(30245),b=t(8311);function m(e){var n=(0,u.Z)(w).data,t=(0,g.Z)(),o=(0,p.Z)((function(){return{clipPath:"none",doorsApi:{},isHoleShown:{},wire:new s.x,onToggleLight:function(e){var t=e.target;if(n){var r=Number(t.getAttribute("data-index"));r in o.isHoleShown?delete o.isHoleShown[r]:o.isHoleShown[r]=!0,o.updateMask()}},updateMask:function(){if(n){var e=n.d.roomGraph,r=Object.keys(o.isHoleShown).map(Number),i=o.doorsApi.getOpen(),a=r.flatMap((function(n){return e.getEnterableRooms(e.nodesArray[n],i).map((function(e){return e.holeIndex}))})),s=Array.from(new Set(r.concat(a))).map((function(e){return n.d.holesWithDoors[e]})),l=e.getAdjacentDoors(r.map((function(n){return e.nodesArray[n]})));this.doorsApi.setObservableDoors(l.map((function(e){return e.doorIndex})));var d=c.LA.cutOut(s,[n.d.hullOutline]).map((function(e){return e.translate(-n.d.pngRect.x,-n.d.pngRect.y)})).map((function(e){return"".concat(e.svgPath)})).join(" ");o.clipPath="path('".concat(d,"')"),t()}}}}),[n]);return i.default.useEffect((function(){if(n){o.updateMask();var e=o.wire.pipe((0,l.h)((function(e){return"closed-door"===e.key||"opened-door"===e.key}))).subscribe((function(e){return o.updateMask()}));return function(){return e.unsubscribe()}}}),[n]),(0,b.tZ)(h.Z,{dark:!0,className:v,children:n&&(0,b.BX)(b.HY,{children:[(0,b.tZ)("img",{className:"geomorph",src:(0,d.qX)(w),draggable:!1,style:{left:n.d.pngRect.x,top:n.d.pngRect.y,width:n.d.pngRect.width,height:n.d.pngRect.height}}),(0,b.tZ)("img",{className:"geomorph-dark",src:(0,d.qX)(w),draggable:!1,style:{left:n.d.pngRect.x,top:n.d.pngRect.y,width:n.d.pngRect.width,height:n.d.pngRect.height,clipPath:o.clipPath}}),(0,b.tZ)("div",{className:"light-toggles",onClick:o.onToggleLight,children:n.d.holeSwitches.map((function(e,n){return(0,b.tZ)("div",{"data-index":n,className:"toggle",style:{left:e.x-5,top:e.y-5,borderColor:o.isHoleShown[n]?"#5f5":"rgba(200, 0, 0, 0.3)",outline:o.isHoleShown[n]?"1px solid black":"1px solid rgba(255, 255, 255, 0.5)"}},n)}))}),(0,b.tZ)(f.Z,{gm:n,wire:o.wire,onLoad:function(e){return o.doorsApi=e}})]})})}var w="g-301--bridge",v=(0,a.iv)(o||(o=(0,r.Z)(["\n  img.geomorph-dark {\n    filter: invert(100%) brightness(55%) contrast(200%) sepia(0%);\n    position: absolute;\n  }\n  img.geomorph {\n    filter: brightness(80%);\n    position: absolute;\n  }\n  /* img.geomorph-light {\n    filter:  brightness(75%);\n    position: absolute;\n  } */\n  div.light-toggles {\n    position: absolute;\n\n    div.toggle {\n      border-radius: 5px;\n      border: 5px solid white;\n      position: absolute;\n      cursor: pointer;\n    }\n  }\n  svg.room-graph {\n    position: absolute;\n    pointer-events: none;\n    circle, line {\n      pointer-events: none;\n    }\n  }\n"])))}}]);