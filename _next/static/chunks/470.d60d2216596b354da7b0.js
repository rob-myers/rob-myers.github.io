"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[470],{97470:function(e,n,t){t.r(n),t.d(n,{default:function(){return P}});var r,i,o=t(52209),a=t(92809),l=t(79056),c=t(30266),s=t(809),p=t.n(s),u=t(59748),d=t(88269),g=t(88767),f=t(35490),y=t(48103),h=t(96005),v=t(91441),E=t(83159),b=t(12891),m=t(94184),w=t.n(m),O=t(8311);function x(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?x(Object(t),!0).forEach((function(n){(0,a.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function P(e){var n,t=(0,g.useQuery)((0,v.tU)("g-301--bridge"),(0,c.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch((0,v.tU)("g-301--bridge")).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})))).data,r=u.default.useState((function(){return{rootEl:{},pathEl:null,source:new y.dl(300,300),target:new y.dl(600,300),path:[],pathfinding:new h.B,zone:void 0,navPoly:[],updatePath:function(){var e,n,t=o.pathfinding.getGroup(D,o.source);null!==t&&(o.path=[o.source.clone()].concat((null===(e=o.pathfinding.findPath(o.source,o.target,D,t))||void 0===e?void 0:e.path)||[]),o.pathEl=o.pathEl||o.rootEl.querySelector("polyline.navpath"),null===(n=o.pathEl)||void 0===n||n.setAttribute("points","".concat(o.path)))}}})),i=(0,l.Z)(r,2),o=i[0],a=i[1];return u.default.useEffect((function(){!t||e.disabled||o.zone||(o.zone=h.B.createZone(t.navDecomp),o.pathfinding.setZoneData(D,o.zone),o.navPoly=t.navPoly.map((function(e){return y.LA.from(e)})),a(Z({},o)))}),[t,e.disabled]),(0,O.tZ)(E.Z,{gridBounds:f.l,initViewBox:j,maxZoom:6,children:(0,O.BX)("g",{className:w()(k,!e.disabled&&S),ref:function(e){e&&(o.rootEl=e,o.updatePath())},children:[t&&(0,O.tZ)("image",Z(Z({},t.pngRect),{},{className:"geomorph",href:(0,v.qX)("g-301--bridge")})),null===(n=o.zone)||void 0===n?void 0:n.groups.map((function(e){return e.map((function(e){var n=e.vertexIds;return(0,O.tZ)("polygon",{className:"navtri",points:"".concat(n.map((function(e){var n;return null===(n=o.zone)||void 0===n?void 0:n.vertices[e]})))})}))})),(0,O.tZ)(b.Z,{initial:o.source,icon:"run",onStop:function(e){if(!o.navPoly.some((function(n){return n.contains(e)})))return"cancel";o.source.copy(e),o.updatePath()}}),(0,O.tZ)("polyline",{className:"navpath",points:"".concat(o.path)}),(0,O.tZ)(b.Z,{initial:o.target,icon:"finish",onStop:function(e){if(!o.navPoly.some((function(n){return n.contains(e)})))return"cancel";o.target.copy(e),o.updatePath()}})]})})}var k=(0,d.iv)(r||(r=(0,o.Z)(["\n  border: 1px solid #555555;\n  height: inherit;\n\n  polyline.navpath {\n    fill: none;\n    stroke: #083;\n    stroke-width: 4;\n    stroke-dasharray: 8px;\n    stroke-dashoffset: 16px;\n  }\n\n  @keyframes flash {\n    0% { stroke-dashoffset: 16px; }\n    100% { stroke-dashoffset: 0px; }\n  }\n\n  polygon.navtri {\n    fill: transparent;\n    &:hover {\n      stroke: #900;\n    }\n  }\n"]))),S=(0,d.iv)(i||(i=(0,o.Z)(["\n  polyline.navpath {\n    animation: 600ms flash infinite linear;\n  }\n"]))),D="NavStringPullZone",j=new y.UL(200,0,600,600)},12891:function(e,n,t){t.d(n,{Z:function(){return g}});var r,i=t(52209),o=t(92809),a=t(79056),l=t(88269),c=t(59748),s=t(48103),p=t(50269),u=t(8311);function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function g(e){var n=c.default.useState((function(){return{position:s.dl.from(e.initial),target:s.dl.from(e.initial),dragging:!1,rootEl:{},lineEl:{},circleEl:{},startDrag:function(n){var t;n.stopPropagation(),r.dragging=!0,r.lineEl.style.display="inline",r.target.copy(r.position),["x1","x2"].forEach((function(e){return r.lineEl.setAttribute(e,String(r.position.x))})),["y1","y2"].forEach((function(e){return r.lineEl.setAttribute(e,String(r.position.y))}));var i=r.lineEl.ownerSVGElement;i.addEventListener("pointermove",r.onMove),i.addEventListener("pointerleave",r.endDrag),i.addEventListener("pointerup",r.applyDrag),window.addEventListener("keydown",r.endDragOnEscape),i.style.cursor="grabbing",null===(t=e.onStart)||void 0===t||t.call(e)},onMove:function(e){if(e.stopPropagation(),r.dragging){var n=(0,p.zk)({clientX:e.clientX,clientY:e.clientY,ownerSvg:r.lineEl.ownerSVGElement,pointerId:null}),t=n.x,i=n.y;r.target.set(t,i),r.lineEl.setAttribute("x2",String(t)),r.lineEl.setAttribute("y2",String(i))}},endDrag:function(){r.dragging=!1,r.lineEl.style.display="none",r.lineEl.setAttribute("x2",r.lineEl.getAttribute("x1")),r.lineEl.setAttribute("y2",r.lineEl.getAttribute("y1"));var e=r.lineEl.ownerSVGElement;e.removeEventListener("pointermove",r.onMove),e.removeEventListener("pointerleave",r.endDrag),e.removeEventListener("pointerup",r.applyDrag),window.removeEventListener("keydown",r.endDragOnEscape),e.style.cursor="auto"},applyDrag:function(){var n;r.endDrag(),"cancel"===(null===(n=e.onStop)||void 0===n?void 0:n.call(e,s.dl.from(r.target)))||(r.position.copy(r.target),r.lineEl.setAttribute("x1",String(r.target.x)),r.lineEl.setAttribute("y1",String(r.target.y)),i(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},r)))},endDragOnEscape:function(e){"Escape"===e.key&&r.endDrag()}}})),t=(0,a.Z)(n,2),r=t[0],i=t[1],l=e.radius||8;return(0,u.BX)("g",{className:f,ref:function(e){e&&(r.rootEl=e,r.lineEl=e.querySelector("line.drag-indicator"),r.circleEl=e.querySelector("circle.node"),r.circleEl.addEventListener("pointerdown",r.startDrag),r.circleEl.addEventListener("pointerup",r.applyDrag))},children:[e.icon&&{eye:(0,u.tZ)("image",{href:"/icon/Simple_Icon_Eye.svg",width:"20",height:"20",x:r.position.x-10,y:r.position.y-10}),down:(0,u.tZ)("image",{href:"/icon/solid_arrow-circle-down.svg",width:"20",height:"20",x:r.position.x-10,y:r.position.y-10}),right:(0,u.tZ)("image",{href:"/icon/solid_arrow-circle-right.svg",width:"20",height:"20",x:r.position.x-10,y:r.position.y-10}),run:(0,u.tZ)("image",{href:"/icon/person-running-fa6.svg",width:"20",height:"20",x:r.position.x-10,y:r.position.y-10}),finish:(0,u.tZ)("image",{href:"/icon/flag-checkered-fa6.svg",width:"20",height:"20",x:r.position.x-10,y:r.position.y-10})}[e.icon]||(0,u.tZ)("circle",{className:"inner-node",cx:r.position.x,cy:r.position.y,r:l}),(0,u.tZ)("circle",{className:"node",cx:r.position.x,cy:r.position.y,r:l+20}),(0,u.tZ)("line",{className:"drag-indicator",stroke:e.stroke||"blue"})]})}var f=(0,l.iv)(r||(r=(0,i.Z)(["\n  circle.node {\n    fill: rgba(0, 0, 0, 0.2);\n    cursor: pointer;\n  }\n  circle.inner-node {\n    stroke: black;\n    cursor: pointer;\n    stroke-width: 0.5;\n  }\n  line.drag-indicator {\n    display: none;\n    stroke-width: 2.5;\n    user-select: none;\n    pointer-events: none;\n  }\n"])))}}]);