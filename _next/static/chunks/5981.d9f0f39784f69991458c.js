"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5981],{85981:function(t,r,e){e.r(r),e.d(r,{default:function(){return m}});var n,o=e(52209),i=e(92809),c=(e(59748),e(88269)),u=e(35490),s=e(91441),a=e(83159),l=e(95814),f=e(8311);function p(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?p(Object(e),!0).forEach((function(r){(0,i.Z)(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function m(t){var r=(0,l.Z)(t.layoutKey).data;return(0,f.tZ)(a.Z,{gridBounds:u.l,initViewBox:u.r,maxZoom:8,className:h,children:r&&(0,f.BX)(f.HY,{children:[(0,f.tZ)("image",d(d({},r.pngRect),{},{className:"geomorph",href:(0,s.qX)(t.layoutKey)})),!t.disabled&&(0,f.tZ)(y,{gm:r})]})})}function y(t){var r=t.gm;return(0,f.tZ)("foreignObject",d(d({},r.pngRect),{},{xmlns:"http://www.w3.org/1999/xhtml",children:(0,f.tZ)("div",{onPointerUp:function(t){var e=t.target,n=[e.clientWidth,Number(e.getAttribute("data-index"))],o=n[1],i=n[0]<=10?r.doors[o].rect.width:10;e.style.width="".concat(i,"px")},children:r.doors.map((function(t,e){var n=t.rect,o=t.angle;return(0,f.tZ)("div",{className:"door","data-index":e,style:{left:n.x-r.pngRect.x,top:n.y-r.pngRect.y,width:n.width,height:n.height,transformOrigin:"top left",transform:"rotate(".concat(o,"rad)")}})}))})}))}var h=(0,c.iv)(n||(n=(0,o.Z)(["\n  foreignObject {\n    div.door {\n      position: absolute;\n      cursor: pointer;\n      background: white;\n      border: 1px solid black;\n\n      transition: width 500ms ease;\n      &.open {\n        width: 0;\n      }\n    }\n  }\n"])))},95814:function(t,r,e){e.d(r,{Z:function(){return y}});var n=e(92809),o=e(97131),i=e(30266),c=e(809),u=e.n(c),s=e(88767),a=e(91441),l=e(48103),f=e(2026),p=e(5524);function d(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function m(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?d(Object(e),!0).forEach((function(r){(0,n.Z)(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):d(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function y(t,r){return(0,s.useQuery)((0,a.tU)(t),(0,i.Z)(u().mark((function r(){var e,n,i,c,s,f;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch((0,a.tU)(t)).then((function(t){return t.json()})).then(p.Vn);case 2:return e=r.sent,n=e.roomGraph,i=n.nodesArray.filter((function(t){return"room"===t.type})).map((function(t,r){var i=n.getEdgesFrom(t).flatMap((function(t){var r=t.dst;return"door"===r.type?e.doors[r.doorId].poly:[]}));return l.LA.union([e.rooms[r]].concat((0,o.Z)(i)))[0]})),c=e.groups.singles.filter((function(t){return t.tags.includes("switch")})).map((function(t){return t.poly.center})),s=e.groups.singles.filter((function(t){return t.tags.includes("spawn")})).map((function(t){return t.poly.center})),(f=m(m({},e),{},{roomsWithDoors:i,roomsSwitch:e.rooms.map((function(t){return c.find((function(r){return t.contains(r)}))||t.rect.center})),hullDoors:e.doors.filter((function(t){return t.tags.includes("hull")})),hullOutline:e.hullPoly[0].removeHoles(),pngRect:l.UL.fromJson(e.items[0].pngRect),spawnPoints:s,lazy:null})).lazy=h(f),g(f),r.abrupt("return",f);case 11:case"end":return r.stop()}}),r)}))),m({cacheTime:1/0},r))}function h(t){var r={roomNavPoly:{}},e=new Proxy({},{get:function(e,n){if("string"===typeof n){var o=Number(n);return t.roomsWithDoors[o]&&!r.roomNavPoly[o]&&(r.roomNavPoly[o]=l.LA.intersect(t.navPoly,[t.roomsWithDoors[o]])),r.roomNavPoly[o]}}});return new Proxy(r,{get:function(t,r){if("roomNavPoly"===r)return e}})}function g(t){t.navZone.doorNodeIds.forEach((function(r,e){var n=t.doors[e];if(t.hullDoors.includes(n)){var i,c=n.roomIds.find(Boolean);if(Number.isFinite(c))(i=t.navZone.roomNodeIds[c]).push.apply(i,(0,o.Z)(r));else(0,f.ZK)("extendRoomNodeIds: ".concat(t.key," (hull) door ").concat(e," has empty roomIds"))}}))}}}]);