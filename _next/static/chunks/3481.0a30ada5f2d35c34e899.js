"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3481],{73481:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var o,r=n(52209),i=n(97131),a=n(59748),s=n(88269),l=n(95090),u=n(36694),c=n(48103),p=n(91441),h=n(84175),g=(n(68451),n(60168),n(35650)),d=n(27375),f=n(97301),m=n(87079),b=n(30245),y=n(8311);function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function k(e){var t=(0,d.Z)(),n=(0,f.Z)([{layoutKey:"g-101--multipurpose"}]),o=n.gms,r=n.gmGraph,s=o[0],w=(0,g.Z)((function(){return{clipPath:"none",doorsApi:{},isHoleShown:{0:!0},wire:new l.x,onToggleLight:function(e){var t=e.target,n=Number(t.getAttribute("data-index"));n in w.isHoleShown?delete w.isHoleShown[n]:w.isHoleShown[n]=!0,w.updateMasks()},updateMasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=(0,h.Nh)(s),o=(n.doors,n.windows,n.holes,n.pngRect),a=n.hullOutline,l=n.holesWithDoors,u=n.roomGraph,p=Object.keys(w.isHoleShown).map(Number),g=w.doorsApi.getOpen(0),d=p.flatMap((function(e){return r.computeLightPolygons(0,e,g)})),f=p.map((function(e){return l[e]})).concat(d).map((function(e){return e.precision(3)})),m=u.getAdjacentDoors.apply(u,(0,i.Z)(p.map((function(e){return u.nodesArray[e]}))));this.doorsApi.setObservableDoors(0,m.map((function(e){return e.doorIndex})));var b=c.LA.cutOut(f,[a]).map((function(e){return e.translate(-o.x,-o.y)})),y=b.map((function(e){return"".concat(e.svgPath)})).join(" ");t(),setTimeout((function(){w.clipPath="path('".concat(y,"')"),t()}),e)}}}),[s],{equality:{isHoleShown:!0}});return a.default.useEffect((function(){if(s){var e,t=v(Object.keys(w.isHoleShown).map(Number));try{for(t.s();!(e=t.n()).done;){var n=e.value;s.holes[n]||delete w.isHoleShown[n]}}catch(r){t.e(r)}finally{t.f()}w.updateMasks();var o=w.wire.pipe((0,u.h)((function(e){return"closed-door"===e.key||"opened-door"===e.key}))).subscribe((function(e){return w.updateMasks("closed-door"===e.key?300:0)}));return function(){return o.unsubscribe()}}}),[s]),(0,y.tZ)(m.Z,{dark:!0,className:S,children:s&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("img",{className:"geomorph",src:(0,p.qX)(s.key),draggable:!1,style:{left:s.pngRect.x,top:s.pngRect.y,width:s.pngRect.width,height:s.pngRect.height}}),(0,y.tZ)("img",{className:"geomorph-dark",src:(0,p.qX)(s.key),draggable:!1,style:{left:s.pngRect.x,top:s.pngRect.y,width:s.pngRect.width,height:s.pngRect.height,clipPath:w.clipPath,WebkitClipPath:w.clipPath}}),(0,y.tZ)("div",{className:"light-toggles",onClick:w.onToggleLight,children:s.holeSwitches.map((function(e,t){return(0,y.tZ)("div",{"data-index":t,className:"toggle",style:{left:e.x-5,top:e.y-5,borderColor:w.isHoleShown[t]?"#5f5":"rgba(200, 0, 0, 0.3)",outline:w.isHoleShown[t]?"1px solid black":"1px solid rgba(255, 255, 255, 0.5)"}},t)}))}),(0,y.tZ)(b.Z,{gms:o,wire:w.wire,onLoad:function(e){return w.doorsApi=e}})]})})}var S=(0,s.iv)(o||(o=(0,r.Z)(["\n  img.geomorph-dark {\n    position: absolute;\n    filter: invert(100%) brightness(45%) contrast(200%) sepia(0%) hue-rotate(0deg) blur(0px);\n  }\n  img.geomorph {\n    position: absolute;\n    filter: brightness(65%) sepia(50%) hue-rotate(180deg);\n  }\n  div.light-toggles {\n    position: absolute;\n\n    div.toggle {\n      border-radius: 5px;\n      border: 5px solid white;\n      position: absolute;\n      cursor: pointer;\n    }\n  }\n  svg.room-graph {\n    position: absolute;\n    pointer-events: none;\n    circle, line {\n      pointer-events: none;\n    }\n  }\n"])))}}]);