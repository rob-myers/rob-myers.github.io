"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9660],{82405:function(e,t,n){n.d(t,{b:function(){return f}});var r=n(97131),o=n(68216),i=n(25997),u=n(92809),c=n(34061),s=n.n(c),a=n(84175);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(){function e(){(0,o.Z)(this,e),(0,u.Z)(this,"nodes",void 0),(0,u.Z)(this,"succ",void 0),(0,u.Z)(this,"pred",void 0),(0,u.Z)(this,"nodesArray",void 0),(0,u.Z)(this,"edgesArray",void 0),(0,u.Z)(this,"idToNode",void 0),(0,u.Z)(this,"idToEdge",void 0),this.nodes=new Set,this.succ=new Map,this.pred=new Map,this.nodesArray=[],this.edgesArray=[],this.idToNode=new Map,this.idToEdge=new Map}return(0,i.Z)(e,[{key:"getReachableNodes",value:function(e){for(var t=this,n=new Set([e]),r=0,o=[e];n.size>r;)r=n.size,(o=(0,a.xH)(o.map((function(e){return t.getSuccs(e)})))).forEach((function(e){return n.add(e)}));return Array.from(n.values())}},{key:"getReachableUpto",value:function(e,t){for(var n=this,r=new Set([e]),o=0,i=[e];r.size>o;)o=r.size,(i=(0,a.xH)(i.map((function(e){return t(e)?[]:n.getSuccs(e)})))).forEach((function(e){return r.add(e)}));return Array.from(r.values())}},{key:"reset",value:function(){this.nodes.clear(),this.succ.clear(),this.pred.clear(),this.nodesArray=[],this.edgesArray=[],this.idToNode.clear(),this.idToEdge.clear()}},{key:"removeNode",value:function(e){var t=this;return!!this.nodes.has(e)&&(this.nodes.delete(e),(0,a.Dm)(this.nodesArray,e),this.idToNode.delete(e.id),this.getPreds(e).forEach((function(n){return t.removeEdge(t.getEdge(n,e))})),this.getSuccs(e).forEach((function(n){return t.removeEdge(t.getEdge(e,n))})),this.succ.delete(e),this.pred.delete(e),!0)}},{key:"connect",value:function(e){var t=this.getNodeById(e.src),n=this.getNodeById(e.dst);if(t&&n){var r=this.getEdge(t,n);return r?{edge:r,isNew:!1}:(this.registerEdge(e),{edge:r,isNew:!0})}return console.error("Can't connect nodes:",t,n,"given",e,"in",this),{isNew:!1,edge:null}}},{key:"disconnect",value:function(e,t){var n=this.getEdge(e,t);return n?(this.removeEdge(n),!0):(console.error("Failed to disconnect",e,t,"in",this),!1)}},{key:"removeNodeById",value:function(e){var t=this.idToNode.get(e);return!!t&&this.removeNode(t)}},{key:"disconnectById",value:function(e){var t=this.idToEdge.get(e);return t?this.disconnect(t.src,t.dst):(console.error("Cannot remove non-existent edge '".concat(e,"'.")),!1)}},{key:"disconnectByIds",value:function(e,t){var n=this.idToNode.get(e),r=this.idToNode.get(t);return n&&r?this.disconnect(n,r):(console.error("Cannot remove edge ('".concat(e,"' -> '").concat(t,"') from"),n,"to",r),!1)}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"isConnected",value:function(e,t){var n=this.succ.get(e);return n&&n.has(t)||!1}},{key:"getNodeByid",value:function(e){return this.idToNode.get(e)||null}},{key:"removeEdge",value:function(e){if(e){var t=this.succ.get(e.src);t&&t.delete(e.dst);var n=this.pred.get(e.dst);n&&n.delete(e.src),this.idToEdge.delete(e.id),(0,a.Dm)(this.edgesArray,e)}}},{key:"getParent",value:function(e){var t=this.getPreds(e);return 1===t.length?t[0]:null}},{key:"getSuccs",value:function(e){var t=this.succ.get(e);return t&&Array.from(t.keys())||[]}},{key:"getPreds",value:function(e){var t=this.pred.get(e);return t&&Array.from(t.keys())||[]}},{key:"getEdgesFrom",value:function(e){var t=this.succ.get(e);return t&&Array.from(t.values())||[]}},{key:"getEdgesTo",value:function(e){var t=this.pred.get(e);return t&&Array.from(t.values())||[]}},{key:"nodeHasSucc",value:function(e){var t=this.succ.get(e);return t&&t.size>0||!1}},{key:"nodeHasPred",value:function(e){var t=this.pred.get(e);return t&&t.size>0||!1}},{key:"getNodeById",value:function(e){return this.idToNode.get(e)||null}},{key:"getEdgeById",value:function(e){return this.idToEdge.get(e)||null}},{key:"getEdge",value:function(e,t){var n=this.succ.get(e);return n&&n.get(t)||null}},{key:"registerNode",value:function(e){this.nodes.add(e),this.nodesArray.push(e),this.succ.set(e,new Map),this.pred.set(e,new Map),this.idToNode.set(e.id,e)}},{key:"registerNodes",value:function(e){var t,n=this;e.forEach((function(e){n.nodes.add(e),n.succ.set(e,new Map),n.pred.set(e,new Map),n.idToNode.set(e.id,e)})),(t=this.nodesArray).push.apply(t,(0,r.Z)(e))}},{key:"registerEdge",value:function(e){var t=[this.getNodeById(e.src),this.getNodeById(e.dst)],n=t[0],r=t[1];if(n&&r){var o=d(d({},e),{},{src:n,dst:r,id:"".concat(e.src,"->").concat(e.dst)}),i=this.succ.get(n),u=this.pred.get(r);i.set(r,o),u.set(n,o),this.idToEdge.set(o.id,o),this.edgesArray.push(o)}else console.warn(s().red("error adding edge"),s().yellow(JSON.stringify(e)))}},{key:"plainJson",value:function(){return{nodes:this.nodesArray.map(a.I8),edges:this.edgesArray.map((function(e){return(0,a.I8)(d(d({},e),{},{id:e.id,src:e.src.id,dst:e.dst.id}))}))}}},{key:"plainFrom",value:function(e){var t=this,n=e.nodes.map(a.I8);return this.registerNodes(n),e.edges.forEach((function(e){return t.registerEdge(e)})),this}}]),e}()},81033:function(e,t,n){n.d(t,{c:function(){return i}});var r=n(68216),o=n(25997),i=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"roundNumber",value:function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"sample",value:function(e){return e[Math.floor(Math.random()*e.length)]}},{key:"distanceToSquared",value:function(e,t){var n=e.x-t.x,r=e.y-t.y;return n*n+r*r}},{key:"isPointInPoly",value:function(e,t){for(var n=!1,r=-1,o=e.length,i=o-1;++r<o;i=r)(e[r].y<=t.y&&t.y<e[i].y||e[i].y<=t.y&&t.y<e[r].y)&&t.x<(e[i].x-e[r].x)*(t.y-e[r].y)/(e[i].y-e[r].y)+e[r].x&&(n=!n);return n}},{key:"isVectorInPolygon",value:function(e,t,n){var r=1/0,o=-1/0,i=[];return t.vertexIds.forEach((function(e){r=Math.min(n[e].y,r),o=Math.max(n[e].y,o),i.push(n[e])})),!!(e.y<o+.5&&e.y>r-.5&&this.isPointInPoly(i,e))}},{key:"triarea2",value:function(e,t,n){var r=t.x-e.x,o=t.y-e.y;return-((n.x-e.x)*o-r*(n.y-e.y))}},{key:"vequal",value:function(e,t){return this.distanceToSquared(e,t)<1e-5}}]),e}()},7951:function(e,t,n){n(77503),n(50269),n(48103),n(2026)},39660:function(e,t,n){n.d(t,{AR:function(){return T},te:function(){return N},Mo:function(){return L},OQ:function(){return R},Vn:function(){return S}});var r=n(97131),o=n(92809),i=n(79056),u=n(30266),c=n(809),s=n.n(c),a=(n(77503),n(292)),l=n(48103),d=(n(7951),n(68451)),f=n(91441),h=n(68216),p=n(25997),g=n(91077),y=n(30268),v=n(92953),m=n(82405),w=n(2026);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,v.Z)(e);if(t){var o=(0,v.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,y.Z)(this,n)}}var k=function(e){(0,g.Z)(n,e);var t=b(n);function n(){return(0,h.Z)(this,n),t.apply(this,arguments)}return(0,p.Z)(n,[{key:"getAdjacentDoors",value:function(){for(var e=this,t=new Set,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.forEach((function(n){return e.getSuccs(n).forEach((function(e){return"door"===e.type&&t.add(e)}))})),Array.from(t)}},{key:"getAdjacentHullDoorIds",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.getAdjacentDoors.apply(this,n).map((function(t){return[t,e.doors[t.doorId]]})).flatMap((function(t){var n=(0,i.Z)(t,2),r=n[0].doorId,o=n[1];return o.roomIds.some((function(e){return null===e}))?{doorIndex:r,hullDoorIndex:e.hullDoors.indexOf(o)}:[]}))}},{key:"getAdjacentWindows",value:function(){for(var e=this,t=new Set,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.forEach((function(n){return e.getSuccs(n).forEach((function(e){return"window"===e.type&&t.add(e)}))})),Array.from(t)}},{key:"getAdjacentRooms",value:function(){for(var e=this,t=new Set,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.forEach((function(n){return e.getSuccs(n).forEach((function(e){return"room"===e.type&&t.add(e)}))})),Array.from(t)}},{key:"getDoorNode",value:function(e){return this.getNodeById("door-".concat(e))}},{key:"getWindowNode",value:function(e){return this.getNodeById("window-".concat(e))}},{key:"getRoomNode",value:function(e){return this.getNodeById("room-".concat(e))}},{key:"getEnterableRooms",value:function(e,t){var n=this;return this.getSuccs(e).filter((function(e){return"door"===e.type&&t.includes(e.doorId)})).flatMap((function(e){return n.getSuccs(e)})).filter((function(t){return t.id!==e.id&&"room"===t.type}))}}],[{key:"from",value:function(e){return(new n).plainFrom(e)}},{key:"json",value:function(e,t,n){var o=t.map((function(t){return e.flatMap((function(e,n){return 1===l.LA.union([e,t.poly]).length?n:[]}))})),i=n.map((function(t){return e.flatMap((function(e,n){return 1===l.LA.union([e,t.poly]).length?n:[]}))}));return{nodes:[].concat((0,r.Z)(e.map((function(e,t){return{id:"room-".concat(t),type:"room",roomId:t}}))),(0,r.Z)(t.map((function(e,t){return{id:"door-".concat(t),type:"door",doorId:t}}))),(0,r.Z)(n.map((function(e,t){return{id:"window-".concat(t),type:"window",windowIndex:t}})))),edges:[].concat((0,r.Z)(t.flatMap((function(e,t){var n=o[t];return[1,2].includes(n.length)?n.flatMap((function(e){return[{src:"room-".concat(e),dst:"door-".concat(t)},{dst:"room-".concat(e),src:"door-".concat(t)}]})):((0,w.vU)("door ".concat(t,": unexpected adjacent rooms: ").concat(n)),[])}))),(0,r.Z)(n.flatMap((function(e,t){var n=i[t];return[1,2].includes(n.length)?n.flatMap((function(e){return[{src:"room-".concat(e),dst:"window-".concat(t)},{dst:"room-".concat(e),src:"window-".concat(t)}]})):((0,w.vU)("window ".concat(t,": unexpected adjacent rooms: ").concat(n)),[])}))))}}}]),n}(m.b),x=n(81033),E=n(49345),A=function(){function e(){(0,h.Z)(this,e)}return(0,p.Z)(e,null,[{key:"buildZone",value:function(e){var t=this,n=this._buildNavigationMesh(e);n.vertices.forEach((function(e){e.x=x.c.roundNumber(e.x,2),e.y=x.c.roundNumber(e.y,2)}));var r={};r.vertices=n.vertices;var o=this._buildPolygonGroups(n);return r.groups=new Array(o.length),o.forEach((function(e,n){var o=new Map;e.forEach((function(e,t){return o.set(e,t)}));var i=new Array(e.length);e.forEach((function(e,n){var u=[];e.neighbours.forEach((function(e){return u.push(o.get(e))}));var c=[];e.neighbours.forEach((function(n){return c.push(t._getSharedVerticesInOrder(e,n))}));var s=new E.d(0,0);s.add(r.vertices[e.vertexIds[0]]),s.add(r.vertices[e.vertexIds[1]]),s.add(r.vertices[e.vertexIds[2]]),s.scale(1/3),s.x=x.c.roundNumber(s.x,2),s.y=x.c.roundNumber(s.y,2),i[n]={id:n,centroid:s,neighbours:u,portals:c,vertexIds:e.vertexIds}})),r.groups[n]=i})),r}},{key:"_buildNavigationMesh",value:function(e){return this._buildPolygonsFromTriang(e)}},{key:"_spreadGroupId",value:function(e){for(var t=new Set([e]);t.size>0;){var n=t;t=new Set,n.forEach((function(n){n.group=e.group,n.neighbours.forEach((function(e){void 0===e.group&&t.add(e)}))}))}}},{key:"_buildPolygonGroups",value:function(e){var t=this,n=e.polygons,r=[];return n.forEach((function(e){void 0!==e.group?r[e.group].push(e):(e.group=r.length,t._spreadGroupId(e),r.push([e]))})),r}},{key:"_buildPolygonNeighbours",value:function(e,t){var n=new Set,r=t[e.vertexIds[0]],o=t[e.vertexIds[1]],i=t[e.vertexIds[2]];return r.forEach((function(t){t!==e&&(o.includes(t)||i.includes(t))&&n.add(t)})),o.forEach((function(t){t!==e&&i.includes(t)&&n.add(t)})),n}},{key:"_buildPolygonsFromTriang",value:function(e){for(var t=this,n=[],r=[],o={},u=0;u<e.vs.length;u++)r.push(E.d.from(e.vs[u])),o[u]=[];for(var c=0;c<e.tris.length;c++){var s=(0,i.Z)(e.tris[c],3),a=s[0],l=s[1],d=s[2],f={vertexIds:[a,l,d]};n.push(f),o[a].push(f),o[l].push(f),o[d].push(f)}return n.forEach((function(e){e.neighbours=t._buildPolygonNeighbours(e,o)})),{polygons:n,vertices:r}}},{key:"_getSharedVerticesInOrder",value:function(e,t){var n=e.vertexIds,r=n[0],o=n[1],i=n[2],u=t.vertexIds,c=u.includes(r),s=u.includes(o),a=u.includes(i);return c&&s&&a?Array.from(n):c&&s?[r,o]:s&&a?[o,i]:c&&a?[i,r]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}]),e}();function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return Z.apply(this,arguments)}function Z(){return(Z=(0,u.Z)(s().mark((function e(t,n,o){var i,u,c,d,h,p,g,y,v,m,b,x,E,A,I,N,Z,j,S,L,R;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new l._3,u={singles:[],obstacles:[],walls:[]},t.items.forEach((function(e,t){var o,c,s;i.feedFromArray(e.transform||[1,0,0,1,0,0]);var a=n[e.symbol],d=a.singles,h=a.obstacles,p=a.walls,g=a.hull;t&&(i.a*=.2,i.b*=.2,i.c*=.2,i.d*=.2);var y=d.map((function(e){return{tags:e.tags,poly:e.poly.clone().applyMatrix(i).precision(4)}})).filter((function(t){var n=t.tags;return e.doors&&n.includes("door")?n.some((function(t){return e.doors.includes(t)})):!e.walls||!n.includes("wall")||n.some((function(t){return e.walls.includes(t)}))}));(o=u.singles).push.apply(o,(0,r.Z)(y)),(c=u.obstacles).push.apply(c,(0,r.Z)(h.map((function(e){return e.clone().applyMatrix(i)})))),(s=u.walls).push.apply(s,(0,r.Z)(l.LA.union([].concat((0,r.Z)(p.map((function(e){return e.clone().applyMatrix(i)}))),(0,r.Z)((0,f.LH)(y,"wall")),(0,r.Z)(g.flatMap((function(e){return e.createOutset(2)})).map((function(e){return e.applyMatrix(i)})))))))})),u.singles.forEach((function(e){return e.poly.fixOrientation().precision(4)})),u.obstacles.forEach((function(e){return e.fixOrientation().precision(4)})),u.walls.forEach((function(e){return e.fixOrientation().precision(4)})),c=(0,f.LH)(u.singles,"door"),d=u.walls.flatMap((function(e){return l.LA.cutOut(c,[e])})),h=u.walls,u.walls=l.LA.union(d),u.singles=u.singles.reduce((function(e,t){return e.concat(t.tags.includes("wall")?l.LA.cutOut(c,[t.poly]).map((function(e){return O(O({},t),{},{poly:e})})):t)}),[]),p=t.items.map((function(e){return n[e.symbol]})),g=p[0],y=g.hull.map((function(e){return e.clone().removeHoles()})),v=(0,f.LH)(u.singles,"window"),m=l.LA.cutOut([].concat(d.flatMap((function(e){return e.createOutset(12)})),u.obstacles.flatMap((function(e){return e.createOutset(8)}))),y).map((function(e){return e.cleanFinalReps().fixOrientation().precision(4)})),!o){e.next=22;break}return e.next=19,o.triangulate(m,{minAngle:10});case 19:e.t0=e.sent,e.next=23;break;case 22:e.t0={vs:[],tris:[]};case 23:return b=e.t0,(x=(0,a.vL)(0,0).getContext("2d")).font=f.Dv.font,E=(0,f.J5)(u.singles,"label").map((function(e){var t=e.poly,n=e.tags,r=t.rect.center.json,o=n.filter((function(e){return"label"!==e})).join(" "),i=!o.match(/[gjpqy]/),u={x:x.measureText(o).width,y:i?f.Dv.noTailPx:f.Dv.sizePx},c={x:r.x-.5*u.x,y:r.y-.5*u.y,width:u.x,height:u.y};return{text:o,center:r,rect:c,padded:(new l.UL).copy(c).outset(f.Dv.padX,f.Dv.padY).json}})),(A=l.LA.union(g.hull.concat(h,v))).sort((function(e,t){return e.rect.area>t.rect.area?-1:1})),I=A[0].holes.map((function(e){return new l.LA(e)})),A.slice(1).forEach((function(e){var n=e.outline[0],r=I.find((function(e){return e.contains(n)}));r?r.holes.push(e.outline):(0,w.ZK)("".concat(t.key,": pillar ").concat(JSON.stringify(e.rect.json)," does not reside in any room"))})),N=u.singles.filter((function(e){return e.tags.includes("door")})).map((function(e){return M(e,I)})),Z=u.singles.filter((function(e){return e.tags.includes("window")})).map((function(e){return M(e,I)})),j=l.UL.from.apply(l.UL,(0,r.Z)(g.hull.concat(c).map((function(e){return e.rect})))),N.filter((function(e){return e.tags.includes("hull")})).forEach((function(e){P(e,j)})),S=D(b,N,I),L=k.json(I,N,Z),R=k.from(L),e.abrupt("return",{key:t.key,id:t.id,def:t,groups:u,rooms:I,doors:N,windows:Z,labels:E,navPoly:m,navZone:S,roomGraph:R,hullPoly:g.hull.map((function(e){return e.clone()})),hullTop:l.LA.cutOut(c.concat(v),g.hull),hullRect:j,items:p.map((function(e,n){return{key:e.key,pngHref:n?"/symbol/".concat(e.key,".png"):"/debug/".concat(t.key,".png"),pngRect:e.pngRect,transformArray:t.items[n].transform,transform:t.items[n].transform?"matrix(".concat(t.items[n].transform,")"):void 0}}))});case 39:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){var n=e.poly.rect;n.y===t.y?e.tags.push("hull-n"):n.right===t.right?e.tags.push("hull-e"):n.bottom===t.bottom?e.tags.push("hull-s"):n.x===t.x&&e.tags.push("hull-w")}function M(e,t){var n=e.poly,r=e.tags,o=4===n.outline.length?d.J.polyToAngledRect(n):{baseRect:n.rect,angle:0},u=o.angle,c=o.baseRect,s=d.J.getAngledRectSeg({angle:u,baseRect:c}),a=(0,i.Z)(s,2),l=a[0],f=a[1],h=f.clone().sub(l).rotate(Math.PI/2).normalize(),p=Math.min(c.width,c.height)/2+.05,g=n.center.addScaledVector(h,p).precision(3),y=n.center.addScaledVector(h,-p).precision(3),v=t.reduce((function(e,t,n){return null===e[0]&&t.contains(g)?[n,e[1]]:null===e[1]&&t.contains(y)?[e[0],n]:e}),[null,null]);return{angle:u,baseRect:c.precision(3),poly:n,rect:n.rect,tags:r,seg:[l.precision(3),f.precision(3)],normal:h.precision(3),roomIds:v,entries:[g,y]}}function j(e){var t=l.LA.from(e.poly);return O(O({},e),{},{baseRect:l.UL.fromJson(e.baseRect),poly:t,rect:t.rect,normal:l.dl.from(e.normal),seg:[l.dl.from(e.seg[0]),l.dl.from(e.seg[1])],entries:[l.dl.from(e.entries[0]),l.dl.from(e.entries[1])]})}function S(e){var t=e.def,n=e.groups,r=e.rooms,o=e.doors,i=e.windows,u=e.labels,c=e.navPoly,s=e.navZone,a=e.roomGraph,d=e.hullPoly,f=e.hullRect,h=e.hullTop,p=e.items;return{key:t.key,id:t.id,def:t,groups:{obstacles:n.obstacles.map(l.LA.from),singles:n.singles.map((function(e){return{tags:e.tags,poly:l.LA.from(e.poly)}})),walls:n.walls.map(l.LA.from)},rooms:r.map(l.LA.from),doors:o.map(j),windows:i.map(j),labels:u,navPoly:c.map(l.LA.from),navZone:s,roomGraph:k.from(a),hullPoly:d.map(l.LA.from),hullRect:f,hullTop:h.map(l.LA.from),items:p}}function L(e){return Object.values(e).reduce((function(e,t){return(e[t.key]={key:(n=t).key,hull:n.hull.map(l.LA.from),obstacles:n.obstacles.map(l.LA.from),walls:n.walls.map(l.LA.from),singles:n.singles.map((function(e){var t=e.tags,n=e.poly;return{tags:t,poly:l.LA.from(n)}})),pngRect:n.pngRect,lastModified:n.lastModified})&&e;var n}),{})}function R(e,t){var n=new l._3(t),r=new l.UL(0,0,1200,e.pngRect.height>1e3?1200:600).applyMatrix(n);return O(O({},e),{},{itemKey:"".concat(e.key,"-[").concat(t,"]"),transform:t,transformOrigin:"".concat(-e.pngRect.x,"px ").concat(-e.pngRect.y,"px"),transformStyle:"matrix(".concat(t,")"),matrix:n,inverseMatrix:n.getInverseMatrix(),gridRect:r})}function T(e,t,n){var r=e.roomIds[0]===t?1:e.roomIds[1]===t?-1:null;return null===r&&console.warn("room ".concat(t,": connector: "),e,": roomSign is null"),e.poly.center.addScaledVector(e.normal,n*(r||0))}function D(e,t,n){var r=A.buildZone(e),o=r.groups[0]||[],i=[],u=new l.LA;t.forEach((function(e,t){i[t]=[],o.forEach((function(n,o){u.outline=n.vertexIds.map((function(e){return r.vertices[e]})),d.J.convexPolysIntersect(e.poly.outline,u.outline)&&i[t].push(o)}))}));var c=[];return n.forEach((function(e,t){c[t]=[],o.forEach((function(n,o){n.vertexIds.filter((function(t){return e.outlineContains(r.vertices[t])})).length>=2&&c[t].push(o)}))})),O(O({},r),{},{doorNodeIds:i,roomNodeIds:c})}},2026:function(e,t,n){n.d(t,{vU:function(){return i},ZK:function(){return u}});var r=n(34061),o=n.n(r);function i(){console.error(o().red.apply(o(),arguments))}function u(){console.warn(o().blueBright.apply(o(),arguments))}}}]);